<script>
  const servername = location.hostname.split(".")[0];
  document.getElementById("serverName").innerText = "Server: " + servername;

  async function apply() {
    const version = document.getElementById("version").value;
    const type = document.getElementById("type").value;
    await fetch(`/api/update/${servername}`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ version, type })
    });
    alert("Updated!");
  }

  async function startServer() {
    const res = await fetch(`/api/start/${servername}`, { method: "POST" });
    const data = await res.json();
    alert(data.message || "Server started!");
  }

  async function stopServer() {
    const res = await fetch(`/api/stop/${servername}`, { method: "POST" });
    const data = await res.json();
    alert(data.message || "Server stopped!");
  }

  function openConsole() {
    window.open(`/servers/${servername}/console.log`, '_blank');
  }
</script>
